---
import type { SiteChart } from "../lib/catalog";

interface Props {
  chart: SiteChart;
}

const { chart } = Astro.props;
const base = import.meta.env.BASE_URL;
const totalVulns = chart.images.reduce((sum, img) => sum + img.vulnSummary.total, 0);
---

<a
  href={`${base}charts/${chart.name}/`}
  class="block bg-verity-surface border border-verity-border rounded-lg p-5 hover:border-verity-orbit hover:bg-verity-void/50 transition-all"
>
  <h3 class="font-semibold text-lg mb-1 text-verity-text-primary">{chart.name}</h3>
  <p class="text-sm text-verity-text-secondary mb-3">v{chart.version}</p>
  <div class="flex items-center gap-3 text-sm text-verity-text-muted">
    <span>{chart.images.length} images</span>
    <span class="text-verity-border">|</span>
    {
      totalVulns > 0 ? (
        <span class="text-verity-nucleus">{totalVulns} vulns patched</span>
      ) : (
        <span class="text-verity-nucleus">clean</span>
      )
    }
  </div>
</a>
