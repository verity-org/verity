---
import type { SiteChart } from "../lib/catalog";

interface Props {
  chart: SiteChart;
}

const { chart } = Astro.props;
const base = import.meta.env.BASE_URL;
const totalVulns = chart.images.reduce((sum, img) => sum + img.vulnSummary.total, 0);
---

<a
  href={`${base}charts/${chart.name}/`}
  class="block bg-white border border-gray-200 rounded-lg p-5 hover:border-gray-400 hover:shadow-sm transition-all"
>
  <h3 class="font-semibold text-lg mb-1">{chart.name}</h3>
  <p class="text-sm text-gray-500 mb-3">v{chart.version}</p>
  <div class="flex items-center gap-3 text-sm text-gray-600">
    <span>{chart.images.length} images</span>
    <span class="text-gray-300">|</span>
    {
      totalVulns > 0 ? (
        <span class="text-orange-600">{totalVulns} vulns patched</span>
      ) : (
        <span class="text-green-600">clean</span>
      )
    }
  </div>
</a>
